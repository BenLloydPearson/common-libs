package com.gravity.utilities.analytics

import collection.mutable.ListBuffer
import java.net.URL
import com.gravity.utilities.grvstrings._

/**
 * Created by Jim Plush
 * User: jim
 * Date: 4/28/11
 */

object ReferrerSites {

  // These buffers are only meant for building, so we'll keep them private

  // stores a list of all the sites that are considered "social" like twitter/facebook
  private val socialSites = new ListBuffer[String]()

  // stores a list of all the search engine type sites like google/bing
  private val searchEngines = new ListBuffer[String]()

  socialSites += "360.yahoo.com"
  socialSites += "43people.com"
  socialSites += "43places.com"
  socialSites += "43things.com"
  socialSites += "9rules.com"
  socialSites += "adultfriendfinder.com"
  socialSites += "alexadex.com"
  socialSites += "allconsuming.net"
  socialSites += "advogato.org"
  socialSites += "anobii.com"
  socialSites += "asmallworld.net"
  socialSites += "badoo.com"
  socialSites += "bahu.com"
  socialSites += "blogcatalog.com"
  socialSites += "bebo.com"
  socialSites += "biip.no"
  socialSites += "blackplanet.com"
  socialSites += "broadcaster.com"
  socialSites += "buzznet.com"
  socialSites += "cakefinancial.com"
  socialSites += "capazoo.com"
  socialSites += "care2.com"
  socialSites += "classmates.com"
  socialSites += "cloob.com"
  socialSites += "collegetonight.com"
  socialSites += "couchsurfing.com"
  socialSites += "crushorflush.com"
  socialSites += "dontstayin.com"
  socialSites += "us.cyworld.com"
  socialSites += "vn.cyworld.com"
  socialSites += "cyworld.de"
  socialSites += "tw.cyworld.com"
  socialSites += "cyworld.jp"
  socialSites += "cyworld.com.cn"
  socialSites += "cyworld.co.kr"
  socialSites += "experienceproject.com"
  socialSites += "efamilyties.com"
  socialSites += "facebook.com"
  socialSites += "m.facebook.com"
  socialSites += "faceparty.com"
  socialSites += "friendster.com"
  socialSites += "flixter.com"
  socialSites += "fotolog.net"
  socialSites += "friendsreunited.com"
  socialSites += "fubar.com"
  socialSites += "gather.com"
  socialSites += "geni.com"
  socialSites += "googlemark.org"
  socialSites += "habbo.com"
  socialSites += "habbo.at"
  socialSites += "habbo.be"
  socialSites += "habbo.com.br"
  socialSites += "habbo.ca"
  socialSites += "habbo.cl"
  socialSites += "habbo.cn"
  socialSites += "habbo.com.co"
  socialSites += "habbo.dk"
  socialSites += "habbo.fi"
  socialSites += "habbo.fr"
  socialSites += "habbo.de"
  socialSites += "habbo.ie"
  socialSites += "habbo.it"
  socialSites += "habbo.jp"
  socialSites += "habbo.com.my"
  socialSites += "habbo.com.mx"
  socialSites += "habbo.nl"
  socialSites += "habbo.co.nz"
  socialSites += "habbo.no"
  socialSites += "habbo.pt"
  socialSites += "habbo.ru"
  socialSites += "habbo.com.sg"
  socialSites += "habbo.es"
  socialSites += "habbo.se"
  socialSites += "habbo.ch"
  socialSites += "habbo.co.uk"
  socialSites += "habbo.com.ve"
  socialSites += "hi5.com"
  socialSites += "imeem.com"
  socialSites += "irc-galleria.net"
  socialSites += "iwiw.hu"
  socialSites += "jaiku.com"
  socialSites += "jot.com"
  socialSites += "kinja.com"
  socialSites += "linkedin.com"
  socialSites += "livejournal.com"
  socialSites += "meebo.com"
  socialSites += "meetup.com"
  socialSites += "metawishlist.com"
  socialSites += "migente.com"
  socialSites += "mixi.jp"
  socialSites += "mocospace.com"
  socialSites += "multiply.com"
  socialSites += "muxlim.com"
  socialSites += "mybloglog.com"
  socialSites += "mychurch.com"
  socialSites += "myspace.com"
  socialSites += "myyearbook.com"
  socialSites += "netlog.com"
  socialSites += "ning.com"
  socialSites += "news.ycombinator.com"
  socialSites += "odnoklassniki.ru"
  socialSites += "orkut.com"
  socialSites += "othersonline.com"
  socialSites += "quimble.com"
  socialSites += "perfspot.com"
  socialSites += "plaxo.com"
  socialSites += "pownce.com"
  socialSites += "rateitall.com"
  socialSites += "ravelry.com"
  socialSites += "rawsugar.com"
  socialSites += "reunion.com"
  socialSites += "rollyo.com"
  socialSites += "ryze.com"
  socialSites += "seomoz.org"
  socialSites += "sermo.com"
  socialSites += "slawsome.com"
  socialSites += "spaces.live.com"
  socialSites += "spinspy.com"
  socialSites += "squidoo.com"
  socialSites += "skyrock.com"
  socialSites += "standpoint.com"
  socialSites += "stickam.com"
  socialSites += "storymash.com"
  socialSites += "student.com"
  socialSites += "studivz.net"
  socialSites += "stumbleupon.com"
  socialSites += "tagged.com"
  socialSites += "takingitglobal.org"
  socialSites += "tailrank.com"
  socialSites += "taltopia.com"
  socialSites += "tickme.com"
  socialSites += "travbuddy.com"
  socialSites += "tribe.net"
  socialSites += "tuenti.com"
  socialSites += "twitter.com"
  socialSites += "t.co"
  socialSites += "vkontakte.ru"
  socialSites += "xang.aocm"
  socialSites += "xing.com"
  socialSites += "wayn.com"
  socialSites += "webbiographies.com"
  socialSites += "webridestv.com"
  socialSites += "wink.com"
  socialSites += "yelp.com"
  socialSites += "youmeo.com"
  socialSites += "zooomr.com"




  searchEngines += "123people.com"
  searchEngines += "123people"
  searchEngines += "search.1und1.de"
  searchEngines += "abacho.de"
  searchEngines += "abacho.com"
  searchEngines += "abacho.co.uk"
  searchEngines += "se.abacho.com"
  searchEngines += "tr.abacho.com"
  searchEngines += "abacho.at"
  searchEngines += "abacho.fr"
  searchEngines += "abacho.es"
  searchEngines += "abacho.ch"
  searchEngines += "abacho.it"
  searchEngines += "abcsok.no"
  searchEngines += "verden.abcsok.no"
  searchEngines += "search.about.com"
  searchEngines += "acoon.de"
  searchEngines += "alexa.com"
  searchEngines += "rechercher.aliceadsl.fr"
  searchEngines += "allesklar.de"
  searchEngines += "allesklar.at"
  searchEngines += "allesklar.ch"
  searchEngines += "alltheweb.com"
  searchEngines += "all.by"
  searchEngines += "altavista.com"
  searchEngines += "search.altavista.com"
  searchEngines += "listings.altavista.com"
  searchEngines += "altavista.de"
  searchEngines += "altavista.fr"
  searchEngines += "altavista.com"
  searchEngines += "be-nl.altavista.com"
  searchEngines += "be-fr.altavista.com"
  searchEngines += "apollo.lv/portal/search/"
  searchEngines += "apollo7.de"
  searchEngines += "search.aol.com"
  searchEngines += "search.aol.it"
  searchEngines += "aolsearch.aol.com"
  searchEngines += "aolrecherche.aol.fr"
  searchEngines += "aolrecherches.aol.fr"
  searchEngines += "aolimages.aol.fr"
  searchEngines += "aim.search.aol.com"
  searchEngines += "recherche.aol.fr"
  searchEngines += "find.web.aol.com"
  searchEngines += "recherche.aol.ca"
  searchEngines += "aolsearch.aol.co.uk"
  searchEngines += "search.aol.co.uk"
  searchEngines += "aolrecherche.aol.fr"
  searchEngines += "sucheaol.aol.de"
  searchEngines += "suche.aol.de"
  searchEngines += "suche.aolsvc.de"
  searchEngines += "aolbusqueda.aol.com.mx"
  searchEngines += "alicesuchet.aol.de"
  searchEngines += "suche.aolsvc.de"
  searchEngines += "suche.aol.de"
  searchEngines += "alicesuche.aol.de"
  searchEngines += "suchet2.aol.de"
  searchEngines += "search.hp.my.aol.com.au"
  searchEngines += "search.hp.my.aol.de"
  searchEngines += "search.hp.my.aol.it"
  searchEngines += "search-intl.netscape.com"
  searchEngines += "sm.aport.ru"
  searchEngines += "arama.com"
  searchEngines += "arcor.de"
  searchEngines += "arianna.libero.it"
  searchEngines += "ask.com"
  searchEngines += "web.ask.com"
  searchEngines += "int.ask.com"
  searchEngines += "images.ask.com"
  searchEngines += "ask.reference.com"
  searchEngines += "askkids.com"
  searchEngines += "iwon.ask.com"
  searchEngines += "ask.co.uk"
  searchEngines += "ask.com"
  searchEngines += "qbyrd.com"
  searchEngines += "qbyrd.com"
  searchEngines += "search-results.com"
  searchEngines += "search-results.com"
  searchEngines += "searchatlas.centrum.cz"
  searchEngines += ".austronaut.at"
  searchEngines += ".austronaut.at"
  searchEngines += "search.babylon.com"
  searchEngines += "baidu.com"
  searchEngines += ".baidu.com"
  searchEngines += "zhidao.baidu.com"
  searchEngines += "tieba.baidu.com"
  searchEngines += "news.baidu.com"
  searchEngines += "web.gougou.com"
  searchEngines += "suchmaschine.com"
  searchEngines += "cgi.search.biglobe.ne.jp"
  searchEngines += "bing.com"
  searchEngines += "cc.bingj.com"
  searchEngines += "bing.com/images/search"
  searchEngines += "blogdigger.com"
  searchEngines += "blogpulse.com"
  searchEngines += "search.bluewin.ch"
  searchEngines += "web.canoe.ca"
  searchEngines += "search.centrum.cz"
  searchEngines += "morfeo.centrum.cz"
  searchEngines += "charter.net"
  searchEngines += "pesquisa.clix.pt"
  searchEngines += "search.conduit.com"
  searchEngines += "search.comcast.net"
  searchEngines += "websearch.cs.com"
  searchEngines += "cuil.com"
  searchEngines += "daemon-search.com"
  searchEngines += "dasoertliche.de"
  searchEngines += ".dastelefonbuch.de"
  searchEngines += "search.daum.net"
  searchEngines += "smart.delfi.lv"
  searchEngines += "otsing.delfi.ee"
  searchEngines += "fr.dir.com"
  searchEngines += "dmoz.org"
  searchEngines += "editors.dmoz.org"
  searchEngines += "duckduckgo.com"
  searchEngines += "search.earthlink.net"
  searchEngines += "ecosia.org"
  searchEngines += "eniro.se"
  searchEngines += "eudip.com"
  searchEngines += "eurip.com"
  searchEngines += "euroseek.com"
  searchEngines += "everyclick.com"
  searchEngines += "search.excite.it"
  searchEngines += "search.excite.fr"
  searchEngines += "search.excite.de"
  searchEngines += "search.excite.co.uk"
  searchEngines += "search.excite.es"
  searchEngines += "search.excite.nl"
  searchEngines += "msxml.excite.com"
  searchEngines += "excite.co.jp"
  searchEngines += "exalead.fr"
  searchEngines += "exalead.com"
  searchEngines += "eo.st"
  searchEngines += "fastbrowsersearch.com"
  searchEngines += "recherche.francite.com"
  searchEngines += "fireball.de"
  searchEngines += "firstsfind.com"
  searchEngines += "fixsuche.de"
  searchEngines += "flix.de"
  searchEngines += "forestle.org"
  searchEngines += "forestle.org"
  searchEngines += "forestle.mobi"
  searchEngines += "search.free.fr"
  searchEngines += "search1-2.free.fr"
  searchEngines += "search1-1.free.fr"
  searchEngines += "search.freecause.com"
  searchEngines += "suche.freenet.de"
  searchEngines += "friendfeed.com"
  searchEngines += "gais.cs.ccu.edu.tw"
  searchEngines += "geona.net"
  searchEngines += "gigablast.com"
  searchEngines += "dir.gigablast.com"
  searchEngines += "suche.gmx.net"
  searchEngines += "gnadenmeer.de"
  searchEngines += "search.goo.ne.jp"
  searchEngines += "ocnsearch.goo.ne.jp"
  searchEngines += "google.com"
  searchEngines += "google"
  searchEngines += "ipv6.google.com"
  searchEngines += "go.google.com"
  searchEngines += "search.avg.com"
  searchEngines += "darkoogle.com"
  searchEngines += "search.darkoogle.com"
  searchEngines += "search.hiyo.com"
  searchEngines += "search.incredimail.com"
  searchEngines += "search1.incredimail.com"
  searchEngines += "search2.incredimail.com"
  searchEngines += "search3.incredimail.com"
  searchEngines += "search4.incredimail.com"
  searchEngines += "search.sweetim.com"
  searchEngines += "googleearth.de"
  searchEngines += "googleearth.fr"
  searchEngines += "webcache.googleusercontent.com"
  searchEngines += "encrypted.google.com"
  searchEngines += "blogsearch.google.com"
  searchEngines += "blogsearch.google"
  searchEngines += "google.com/cse"
  searchEngines += "translate.google.com"
  searchEngines += "images.google.com"
  searchEngines += "images.google"
  searchEngines += "news.google.com"
  searchEngines += "news.google"
  searchEngines += "froogle.google.com"
  searchEngines += "froogle.google"
  searchEngines += "googlesyndicatedsearch.com"
  searchEngines += "goyellow.de"
  searchEngines += "gulesider.no"
  searchEngines += "highbeam.com"
  searchEngines += "req.hit-parade.com"
  searchEngines += "class.hit-parade.com"
  searchEngines += "hit-parade.com"
  searchEngines += "holmes.ge"
  searchEngines += "hooseek.com"
  searchEngines += "hotbot.com"
  searchEngines += "blogs.icerocket.com"
  searchEngines += "icq.com"
  searchEngines += "search.icq.com"
  searchEngines += "ilse.nl"
  searchEngines += "infospace.com"
  searchEngines += "dogpile.com"
  searchEngines += "nbci.dogpile.com"
  searchEngines += "search.nation.com"
  searchEngines += "search.go2net.com"
  searchEngines += "metacrawler.com"
  searchEngines += "webfetch.com"
  searchEngines += "webcrawler.com"
  searchEngines += "search.dogreatgood.com"
  searchEngines += "google.interia.pl"
  searchEngines += "start.iplay.com"
  searchEngines += "ixquick.com"
  searchEngines += "eu.ixquick.com"
  searchEngines += "ixquick.de"
  searchEngines += "ixquick.de"
  searchEngines += "us.ixquick.com"
  searchEngines += "s1.us.ixquick.com"
  searchEngines += "s2.us.ixquick.com"
  searchEngines += "s3.us.ixquick.com"
  searchEngines += "s4.us.ixquick.com"
  searchEngines += "s5.us.ixquick.com"
  searchEngines += "eu.ixquick.com"
  searchEngines += "s8-eu.ixquick.com"
  searchEngines += "s1-eu.ixquick.de"
  searchEngines += "jyxo.1188.cz"
  searchEngines += "jungle-spider.de"
  searchEngines += "kataweb.it"
  searchEngines += "kvasir.no"
  searchEngines += "latne.lv"
  searchEngines += "toile.com"
  searchEngines += "web.toile.com"
  searchEngines += "looksmart.com"
  searchEngines += "lo.st"
  searchEngines += "search.lycos.com"
  searchEngines += "lycos"
  searchEngines += "maailm.com"
  searchEngines += "go.mail.ru"
  searchEngines += "mamma.com"
  searchEngines += "mamma75.mamma.com"
  searchEngines += "meta.ua"
  searchEngines += "s1.metacrawler.de"
  searchEngines += "s2.metacrawler.de"
  searchEngines += "s3.metacrawler.de"
  searchEngines += "meta.rrzn.uni-hannover.de"
  searchEngines += "metager.de"
  searchEngines += "metager2.de"
  searchEngines += "meinestadt.de"
  searchEngines += "mister-wong.com"
  searchEngines += "mister-wong.de"
  searchEngines += "monstercrawler.com"
  searchEngines += "mozbot.fr"
  searchEngines += "mozbot.co.uk"
  searchEngines += "mozbot.com"
  searchEngines += "ariadna.elmundo.es"
  searchEngines += "searchservice.myspace.com"
  searchEngines += "mysearch.com"
  searchEngines += "ms114.mysearch.com"
  searchEngines += "ms146.mysearch.com"
  searchEngines += "kf.mysearch.myway.com"
  searchEngines += "ki.mysearch.myway.com"
  searchEngines += "search.myway.com"
  searchEngines += "search.mywebsearch.com"
  searchEngines += "najdi.si"
  searchEngines += "search.nate.com"
  searchEngines += "search.naver.com"
  searchEngines += "ko.search.need2find.com"
  searchEngines += "neti.ee"
  searchEngines += "search.nifty.com"
  searchEngines += "nigma.ru"
  searchEngines += "szukaj.onet.pl"
  searchEngines += "online.no"
  searchEngines += "1881.no"
  searchEngines += "busca.orange.es"
  searchEngines += "paperball.de"
  searchEngines += "search.peoplepc.com"
  searchEngines += "picsearch.com"
  searchEngines += "plazoo.com"
  searchEngines += "poisk.ru"
  searchEngines += "search.qip.ru"
  searchEngines += "qualigo.at"
  searchEngines += "qualigo.ch"
  searchEngines += "qualigo.de"
  searchEngines += "qualigo.nl"
  searchEngines += "websearch.rakuten.co.jp"
  searchEngines += "nova.rambler.ru"
  searchEngines += "rpmfind.net"
  searchEngines += "fr2.rpmfind.net"
  searchEngines += "search.rr.com"
  searchEngines += "pesquisa.sapo.pt"
  searchEngines += "scroogle.org"
  searchEngines += "search.com"
  searchEngines += "search.ch"
  searchEngines += "searchalot.com"
  searchEngines += "searchcanvas.com"
  searchEngines += "seek.fr"
  searchEngines += "searchy.co.uk"
  searchEngines += "bg.setooz.com"
  searchEngines += "da.setooz.com"
  searchEngines += "el.setooz.com"
  searchEngines += "fa.setooz.com"
  searchEngines += "ur.setooz.com"
  searchEngines += "setooz.com"
  searchEngines += "search.seznam.cz"
  searchEngines += "sharelook.fr"
  searchEngines += "skynet.be"
  searchEngines += "sogou.com"
  searchEngines += "soso.com"
  searchEngines += "startgoogle.startpagina.nl"
  searchEngines += "suche.info"
  searchEngines += "suchmaschine.com"
  searchEngines += "suchnase.de"
  searchEngines += "technorati.com"
  searchEngines += "teoma.com"
  searchEngines += "buscador.terra.es"
  searchEngines += "buscador.terra.cl"
  searchEngines += "buscador.terra.com.br"
  searchEngines += "search.tiscali.it"
  searchEngines += "search-dyn.tiscali.it"
  searchEngines += "hledani.tiscali.cz"
  searchEngines += "tixuma.de"
  searchEngines += "suche.t-online.de"
  searchEngines += "brisbane.t-online.de"
  searchEngines += "navigationshilfe.t-online.de"
  searchEngines += "trouvez.com"
  searchEngines += "trovarapido.com"
  searchEngines += "trusted--search.com"
  searchEngines += "twingly.com"
  searchEngines += "vinden.nl"
  searchEngines += "vindex.nl"
  searchEngines += "search.vindex.nl"
  searchEngines += "ricerca.virgilio.it"
  searchEngines += "ricercaimmagini.virgilio.it"
  searchEngines += "ricercavideo.virgilio.it"
  searchEngines += "ricercanews.virgilio.it"
  searchEngines += "search.ke.voila.fr"
  searchEngines += "lemoteur.fr"
  searchEngines += "web.volny.cz"
  searchEngines += "walhello.info"
  searchEngines += "walhello.com"
  searchEngines += "walhello.de"
  searchEngines += "walhello.nl"
  searchEngines += "suche.web.de"
  searchEngines += "web.nl"
  searchEngines += "weborama.fr"
  searchEngines += "websearch.com"
  searchEngines += "fr.wedoo.com"
  searchEngines += "en.wedoo.com"
  searchEngines += "es.wedoo.com"
  searchEngines += "search.winamp.com"
  searchEngines += "witch.de"
  searchEngines += "szukaj.wp.pl"
  searchEngines += "search.ee"
  searchEngines += "x-recherche.com"
  searchEngines += "search.yahoo.com"
  searchEngines += "cade.search.yahoo.com"
  searchEngines += "espanol.search.yahoo.com"
  searchEngines += "qc.search.yahoo.com"
  searchEngines += "yhs.search.yahoo.com"
  searchEngines += "siteexplorer.search.yahoo.com"
  searchEngines += "de.dir.yahoo.com"
  searchEngines += "cf.dir.yahoo.com"
  searchEngines += "fr.dir.yahoo.com"
  searchEngines += "images.search.yahoo.com"
  searchEngines += "images.search.yahoo.com"
  searchEngines += "cade.images.search.yahoo.com"
  searchEngines += "espanol.images.search.yahoo.com"
  searchEngines += "qc.images.search.yahoo.com"
  searchEngines += "images.yahoo.com"
  searchEngines += "images.yahoo.com"
  searchEngines += "cade.images.yahoo.com"
  searchEngines += "espanol.images.yahoo.com"
  searchEngines += "qc.images.yahoo.com"
  searchEngines += "search.yam.com"
  searchEngines += "yandex.com"
  searchEngines += "yandex"
  searchEngines += "images.yandex.com"
  searchEngines += "images.yandex"
  searchEngines += "yasni.de"
  searchEngines += "yasni.com"
  searchEngines += "yasni.co.uk"
  searchEngines += "yasni.ch"
  searchEngines += "yasni.at"
  searchEngines += "yellowmap.de"
  searchEngines += "search.yippy.com"
  searchEngines += "yougoo.fr"
  searchEngines += ".zoek.nl"
  searchEngines += "p.zhongsou.com"
  searchEngines += "zoeken.nl"
  searchEngines += "zoohoo.cz"

  val socialSet: Set[String] = socialSites.toSet
  val searchSet: Set[String] = searchEngines.toSet

  def normalizedHost(url: URL): String = {
    if (url == null) return emptyString

    val rawHost = url.getHost.toLowerCase
    if (rawHost.startsWith("www.")) {
      rawHost.substring(4)
    } else {
      rawHost
    }
  }

  def isSocialSite(url: String): Boolean = url.tryToURL match {
    case Some(u) => isSocialSite(u)
    case None => false
  }

  def isSocialSite(url: URL): Boolean = {
    val host = normalizedHost(url)

    if (host.isEmpty) return false
    if (socialSet.contains(host)) return true

    false
  }

  def isSearchSite(url: String): Boolean = url.tryToURL match {
    case Some(u) => isSearchSite(u)
    case None => false
  }

  def isSearchSite(url: URL): Boolean = {
    val host = normalizedHost(url)

    if (host.isEmpty) return false
    if (searchSet.contains(host)) return true

    false
  }

  def hostInSocialSites(host: String): Boolean = socialSet.contains(host)

  def hostInSearchSites(host: String): Boolean = searchSet.contains(host)
}
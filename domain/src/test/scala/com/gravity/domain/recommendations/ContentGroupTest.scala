package com.gravity.interests.jobs.intelligence

import com.gravity.domain.articles.{ContentGroupSourceTypes, ContentGroupStatus}
import com.gravity.domain.recommendations.ContentGroup
import com.gravity.domain.recommendations.ContentGroup.{ContentGroupByteConverter, ContentGroupJsonSerializer, ContentGroupSeqByteConverter}
import com.gravity.test.SerializationTesting
import com.gravity.utilities.{BaseScalaTest, grvjson}
import net.liftweb.json.Formats
import org.apache.commons.codec.binary.Base64
import org.junit.Assert._
import play.api.libs.json.{JsError, JsSuccess, Json}

import scalaz.syntax.validation._

trait ContentGroupTestResources {
  implicit val formats: Formats = grvjson.baseFormatsPlus(List(ContentGroupJsonSerializer))
}

/**
  * Tests ContentGroup:
  *   Lift JSON (de-)serialization, Play JSON (de-)serialization,
  *   ByteConverter round-trip, Java Serialization round-trip,
  *   ByteConverter and Java de-serialization of older versions of the object (Version 2 code deserializing Version 1 objects)
  *   and can be used to test de-serialization newer objects by older versions of the code (Version 1 code deserializing Version 2 objects).
  *
  * @see [[ContentGroupTestCaseDataGenerator1]] Helpful app to generate data for these test cases.
  */
class ContentGroupTest extends BaseScalaTest with SerializationTesting with ContentGroupTestResources {
  /**
    * @param json JSON as serialized by Play or Lift (deprecated). The reason these can be consolidated is that our two
    *             serializers essentially make the same JSON, albeit with insignificant differences (e.g. field ordering).
    */
  case class TestCaseCg(cas: ContentGroup,
                        cgVersion: Int,
                        json: String,
                        byteConverterVersionToBase64Bytes: Map[Int, String],
                        versionToJavaBase64Bytes: Map[Int, String]
                       )

  val testCasesCg: List[TestCaseCg] = List(
    TestCaseCg(
      ContentGroup(12345L, "CgName1", ContentGroupSourceTypes.advertiser, SiteKey("siteguid1").toScopedKey, "siteguid1", ContentGroupStatus.active),
      1,
      """{"id":12345,"name":"CgName1","sourceType":"advertiser","sourceKey":{"objectKey":"sk_._siteId_5844192064356680644","scope":"site","context":"default_context"},"forSiteGuid":"siteguid1","status":"active"}""",

      Map(
        1 -> "AAAAAAAAMDkAB0NnTmFtZTEEAgABAAFRGr23+yMDxAAJc2l0ZWd1aWQxAQ==",
        2 -> "c1cWlD99m7EAAAACAAAAAAAAMDkAB0NnTmFtZTEEAgABAAFRGr23+yMDxAAJc2l0ZWd1aWQxAQA=",
        3 -> "c1cWlD99m7EAAAADAAAAAAAAMDkAB0NnTmFtZTEEAgABAAFRGr23+yMDxAAJc2l0ZWd1aWQxAQAAAAAAAAAA"
      ),

      Map(
        1 -> "rO0ABXNyAC9jb20uZ3Jhdml0eS5kb21haW4ucmVjb21tZW5kYXRpb25zLkNvbnRlbnRHcm91cLNsffGwL1NuAgAHSgACaWRaAAxpc0dtc01hbmFnZWRMAAtmb3JTaXRlR3VpZHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wABG5hbWVxAH4AAUwACXNvdXJjZUtleXQAOUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvU2NvcGVkS2V5O0wACnNvdXJjZVR5cGV0ADpMY29tL2dyYXZpdHkvZG9tYWluL2FydGljbGVzL0NvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGU7TAAGc3RhdHVzdAA1TGNvbS9ncmF2aXR5L2RvbWFpbi9hcnRpY2xlcy9Db250ZW50R3JvdXBTdGF0dXMkVHlwZTt4cAAAAAAAADA5AHQACXNpdGVndWlkMXQAB0NnTmFtZTFzcgA3Y29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLmhiYXNlLlNjb3BlZEtleaEq4UNcgvRQAgAFWgAIYml0bWFwJDBMAAdjb250ZXh0dABGTGNvbS9ncmF2aXR5L2ludGVyZXN0cy9qb2JzL2ludGVsbGlnZW5jZS9oYmFzZS9TY29wZWRLZXlDb250ZXh0cyRUeXBlO0wACW9iamVjdEtleXQAPkxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvQ2FuQmVTY29wZWRLZXk7TAAFc2NvcGV0AENMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleVR5cGVzJFR5cGU7TAAIdG9TdHJpbmdxAH4AAXhwAHNyADdjb20uZ3Jhdml0eS51dGlsaXRpZXMuZ3J2ZW51bS5HcnZFbnVtJEdydkVudW1TZXJpYWxpemVkZyCDGkoKiEoCAARMAANjbHN0ABFMamF2YS9sYW5nL0NsYXNzO0wACmV2aWRlbmNlJDF0ABhMc2NhbGEvcmVmbGVjdC9DbGFzc1RhZztMAAJpZHQAEkxqYXZhL2xhbmcvT2JqZWN0O0wABG5hbWVxAH4AAXhwdnIARGNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlDb250ZXh0cyRUeXBlwBvYiSTo9OICAAB4cHNyACVzY2FsYS5yZWZsZWN0Lk1hbmlmZXN0RmFjdG9yeSQkYW5vbiQ3UqUKv37iHHkCAAB4cgAcc2NhbGEucmVmbGVjdC5BbnlWYWxNYW5pZmVzdAAAAAAAAAABAgABTAAIdG9TdHJpbmdxAH4AAXhwdAAFU2hvcnRzcgAPamF2YS5sYW5nLlNob3J0aE03EzRg2lICAAFTAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAABdAAPZGVmYXVsdF9jb250ZXh0c3IAL2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5TaXRlS2V5vKMDKZI4eRgCAAFKAAZzaXRlSWR4cFEavbf7IwPEc3EAfgANdnIAQWNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlUeXBlcyRUeXBl9Tjla51yL48CAAB4cHEAfgAWcQB+ABp0AARzaXRlcHNxAH4ADXZyADhjb20uZ3Jhdml0eS5kb21haW4uYXJ0aWNsZXMuQ29udGVudEdyb3VwU291cmNlVHlwZXMkVHlwZfvpCQbuM/bqAgAAeHBzcgAlc2NhbGEucmVmbGVjdC5NYW5pZmVzdEZhY3RvcnkkJGFub24kNkvxQDMwQabgAgAAeHEAfgAVdAAEQnl0ZXNyAA5qYXZhLmxhbmcuQnl0ZZxOYITuUPUcAgABQgAFdmFsdWV4cQB+ABkEdAAKYWR2ZXJ0aXNlcnNxAH4ADXZyADNjb20uZ3Jhdml0eS5kb21haW4uYXJ0aWNsZXMuQ29udGVudEdyb3VwU3RhdHVzJFR5cGXJZaFkLuCUBAIAAHhwcQB+ACZzcQB+ACgBdAAGYWN0aXZl",
        2 -> "rO0ABXNyAC9jb20uZ3Jhdml0eS5kb21haW4ucmVjb21tZW5kYXRpb25zLkNvbnRlbnRHcm91cLNsffGwL1NuAgAHSgACaWRaAAxpc0dtc01hbmFnZWRMAAtmb3JTaXRlR3VpZHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wABG5hbWVxAH4AAUwACXNvdXJjZUtleXQAOUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvU2NvcGVkS2V5O0wACnNvdXJjZVR5cGV0ADpMY29tL2dyYXZpdHkvZG9tYWluL2FydGljbGVzL0NvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGU7TAAGc3RhdHVzdAA1TGNvbS9ncmF2aXR5L2RvbWFpbi9hcnRpY2xlcy9Db250ZW50R3JvdXBTdGF0dXMkVHlwZTt4cAAAAAAAADA5AHQACXNpdGVndWlkMXQAB0NnTmFtZTFzcgA3Y29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLmhiYXNlLlNjb3BlZEtleaEq4UNcgvRQAgAFWgAIYml0bWFwJDBMAAdjb250ZXh0dABGTGNvbS9ncmF2aXR5L2ludGVyZXN0cy9qb2JzL2ludGVsbGlnZW5jZS9oYmFzZS9TY29wZWRLZXlDb250ZXh0cyRUeXBlO0wACW9iamVjdEtleXQAPkxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvQ2FuQmVTY29wZWRLZXk7TAAFc2NvcGV0AENMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleVR5cGVzJFR5cGU7TAAIdG9TdHJpbmdxAH4AAXhwAHNyADdjb20uZ3Jhdml0eS51dGlsaXRpZXMuZ3J2ZW51bS5HcnZFbnVtJEdydkVudW1TZXJpYWxpemVkZyCDGkoKiEoCAARMAANjbHN0ABFMamF2YS9sYW5nL0NsYXNzO0wACmV2aWRlbmNlJDF0ABhMc2NhbGEvcmVmbGVjdC9DbGFzc1RhZztMAAJpZHQAEkxqYXZhL2xhbmcvT2JqZWN0O0wABG5hbWVxAH4AAXhwdnIARGNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlDb250ZXh0cyRUeXBlwBvYiSTo9OICAAB4cHNyACVzY2FsYS5yZWZsZWN0Lk1hbmlmZXN0RmFjdG9yeSQkYW5vbiQ3UqUKv37iHHkCAAB4cgAcc2NhbGEucmVmbGVjdC5BbnlWYWxNYW5pZmVzdAAAAAAAAAABAgABTAAIdG9TdHJpbmdxAH4AAXhwdAAFU2hvcnRzcgAPamF2YS5sYW5nLlNob3J0aE03EzRg2lICAAFTAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAABdAAPZGVmYXVsdF9jb250ZXh0c3IAL2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5TaXRlS2V5vKMDKZI4eRgCAAFKAAZzaXRlSWR4cFEavbf7IwPEc3EAfgANdnIAQWNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlUeXBlcyRUeXBl9Tjla51yL48CAAB4cHEAfgAWcQB+ABp0AARzaXRlcHNxAH4ADXZyADhjb20uZ3Jhdml0eS5kb21haW4uYXJ0aWNsZXMuQ29udGVudEdyb3VwU291cmNlVHlwZXMkVHlwZfvpCQbuM/bqAgAAeHBzcgAlc2NhbGEucmVmbGVjdC5NYW5pZmVzdEZhY3RvcnkkJGFub24kNkvxQDMwQabgAgAAeHEAfgAVdAAEQnl0ZXNyAA5qYXZhLmxhbmcuQnl0ZZxOYITuUPUcAgABQgAFdmFsdWV4cQB+ABkEdAAKYWR2ZXJ0aXNlcnNxAH4ADXZyADNjb20uZ3Jhdml0eS5kb21haW4uYXJ0aWNsZXMuQ29udGVudEdyb3VwU3RhdHVzJFR5cGXJZaFkLuCUBAIAAHhwcQB+ACZzcQB+ACgBdAAGYWN0aXZlrO0ABXNyAC9jb20uZ3Jhdml0eS5kb21haW4ucmVjb21tZW5kYXRpb25zLkNvbnRlbnRHcm91cLNsffGwL1NuAgAHSgACaWRaAAxpc0dtc01hbmFnZWRMAAtmb3JTaXRlR3VpZHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wABG5hbWVxAH4AAUwACXNvdXJjZUtleXQAOUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvU2NvcGVkS2V5O0wACnNvdXJjZVR5cGV0ADpMY29tL2dyYXZpdHkvZG9tYWluL2FydGljbGVzL0NvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGU7TAAGc3RhdHVzdAA1TGNvbS9ncmF2aXR5L2RvbWFpbi9hcnRpY2xlcy9Db250ZW50R3JvdXBTdGF0dXMkVHlwZTt4cAAAAAAAADA5AHQACXNpdGVndWlkMXQAB0NnTmFtZTFzcgA3Y29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLmhiYXNlLlNjb3BlZEtleaEq4UNcgvRQAgAFWgAIYml0bWFwJDBMAAdjb250ZXh0dABGTGNvbS9ncmF2aXR5L2ludGVyZXN0cy9qb2JzL2ludGVsbGlnZW5jZS9oYmFzZS9TY29wZWRLZXlDb250ZXh0cyRUeXBlO0wACW9iamVjdEtleXQAPkxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvQ2FuQmVTY29wZWRLZXk7TAAFc2NvcGV0AENMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleVR5cGVzJFR5cGU7TAAIdG9TdHJpbmdxAH4AAXhwAHNyADdjb20uZ3Jhdml0eS51dGlsaXRpZXMuZ3J2ZW51bS5HcnZFbnVtJEdydkVudW1TZXJpYWxpemVkZyCDGkoKiEoCAARMAANjbHN0ABFMamF2YS9sYW5nL0NsYXNzO0wACmV2aWRlbmNlJDF0ABhMc2NhbGEvcmVmbGVjdC9DbGFzc1RhZztMAAJpZHQAEkxqYXZhL2xhbmcvT2JqZWN0O0wABG5hbWVxAH4AAXhwdnIARGNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlDb250ZXh0cyRUeXBlwBvYiSTo9OICAAB4cHNyACVzY2FsYS5yZWZsZWN0Lk1hbmlmZXN0RmFjdG9yeSQkYW5vbiQ3UqUKv37iHHkCAAB4cgAcc2NhbGEucmVmbGVjdC5BbnlWYWxNYW5pZmVzdAAAAAAAAAABAgABTAAIdG9TdHJpbmdxAH4AAXhwdAAFU2hvcnRzcgAPamF2YS5sYW5nLlNob3J0aE03EzRg2lICAAFTAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAABdAAPZGVmYXVsdF9jb250ZXh0c3IAL2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5TaXRlS2V5vKMDKZI4eRgCAAFKAAZzaXRlSWR4cFEavbf7IwPEc3EAfgANdnIAQWNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlUeXBlcyRUeXBl9Tjla51yL48CAAB4cHEAfgAWcQB+ABp0AARzaXRlcHNxAH4ADXZyADhjb20uZ3Jhdml0eS5kb21haW4uYXJ0aWNsZXMuQ29udGVudEdyb3VwU291cmNlVHlwZXMkVHlwZfvpCQbuM/bqAgAAeHBzcgAlc2NhbGEucmVmbGVjdC5NYW5pZmVzdEZhY3RvcnkkJGFub24kNkvxQDMwQabgAgAAeHEAfgAVdAAEQnl0ZXNyAA5qYXZhLmxhbmcuQnl0ZZxOYITuUPUcAgABQgAFdmFsdWV4cQB+ABkEdAAKYWR2ZXJ0aXNlcnNxAH4ADXZyADNjb20uZ3Jhdml0eS5kb21haW4uYXJ0aWNsZXMuQ29udGVudEdyb3VwU3RhdHVzJFR5cGXJZaFkLuCUBAIAAHhwcQB+ACZzcQB+ACgBdAAGYWN0aXZl",
        3 -> "rO0ABXNyAC9jb20uZ3Jhdml0eS5kb21haW4ucmVjb21tZW5kYXRpb25zLkNvbnRlbnRHcm91cLNsffGwL1NuAgALSgACaWRaAAhpc0F0aGVuYVoADGlzR21zTWFuYWdlZEwADWNodWJDaGFubmVsSWR0ABJMamF2YS9sYW5nL1N0cmluZztMAAxjaHViQ2xpZW50SWRxAH4AAUwACmNodWJGZWVkSWRxAH4AAUwAC2ZvclNpdGVHdWlkcQB+AAFMAARuYW1lcQB+AAFMAAlzb3VyY2VLZXl0ADlMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleTtMAApzb3VyY2VUeXBldAA6TGNvbS9ncmF2aXR5L2RvbWFpbi9hcnRpY2xlcy9Db250ZW50R3JvdXBTb3VyY2VUeXBlcyRUeXBlO0wABnN0YXR1c3QANUxjb20vZ3Jhdml0eS9kb21haW4vYXJ0aWNsZXMvQ29udGVudEdyb3VwU3RhdHVzJFR5cGU7eHAAAAAAAAAwOQAAdAAAcQB+AAZxAH4ABnQACXNpdGVndWlkMXQAB0NnTmFtZTFzcgA3Y29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLmhiYXNlLlNjb3BlZEtleaEq4UNcgvRQAgAFWgAIYml0bWFwJDBMAAdjb250ZXh0dABGTGNvbS9ncmF2aXR5L2ludGVyZXN0cy9qb2JzL2ludGVsbGlnZW5jZS9oYmFzZS9TY29wZWRLZXlDb250ZXh0cyRUeXBlO0wACW9iamVjdEtleXQAPkxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvQ2FuQmVTY29wZWRLZXk7TAAFc2NvcGV0AENMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleVR5cGVzJFR5cGU7TAAIdG9TdHJpbmdxAH4AAXhwAHNyADdjb20uZ3Jhdml0eS51dGlsaXRpZXMuZ3J2ZW51bS5HcnZFbnVtJEdydkVudW1TZXJpYWxpemVkZyCDGkoKiEoCAARMAANjbHN0ABFMamF2YS9sYW5nL0NsYXNzO0wACmV2aWRlbmNlJDF0ABhMc2NhbGEvcmVmbGVjdC9DbGFzc1RhZztMAAJpZHQAEkxqYXZhL2xhbmcvT2JqZWN0O0wABG5hbWVxAH4AAXhwdnIARGNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlDb250ZXh0cyRUeXBlwBvYiSTo9OICAAB4cHNyACVzY2FsYS5yZWZsZWN0Lk1hbmlmZXN0RmFjdG9yeSQkYW5vbiQ3UqUKv37iHHkCAAB4cgAcc2NhbGEucmVmbGVjdC5BbnlWYWxNYW5pZmVzdAAAAAAAAAABAgABTAAIdG9TdHJpbmdxAH4AAXhwdAAFU2hvcnRzcgAPamF2YS5sYW5nLlNob3J0aE03EzRg2lICAAFTAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAABdAAPZGVmYXVsdF9jb250ZXh0c3IAL2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5TaXRlS2V5vKMDKZI4eRgCAAFKAAZzaXRlSWR4cFEavbf7IwPEc3EAfgAOdnIAQWNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlUeXBlcyRUeXBl9Tjla51yL48CAAB4cHEAfgAXcQB+ABt0AARzaXRlcHNxAH4ADnZyADhjb20uZ3Jhdml0eS5kb21haW4uYXJ0aWNsZXMuQ29udGVudEdyb3VwU291cmNlVHlwZXMkVHlwZfvpCQbuM/bqAgAAeHBzcgAlc2NhbGEucmVmbGVjdC5NYW5pZmVzdEZhY3RvcnkkJGFub24kNkvxQDMwQabgAgAAeHEAfgAWdAAEQnl0ZXNyAA5qYXZhLmxhbmcuQnl0ZZxOYITuUPUcAgABQgAFdmFsdWV4cQB+ABoEdAAKYWR2ZXJ0aXNlcnNxAH4ADnZyADNjb20uZ3Jhdml0eS5kb21haW4uYXJ0aWNsZXMuQ29udGVudEdyb3VwU3RhdHVzJFR5cGXJZaFkLuCUBAIAAHhwcQB+ACdzcQB+ACkBdAAGYWN0aXZl"
      )
    ),

    TestCaseCg(
      ContentGroup(123456789L, "CgName2", ContentGroupSourceTypes.campaign  , CampaignKey(SiteKey("siteguid2"), 23456L).toScopedKey, "siteguid2", ContentGroupStatus.inactive),
      1,
      """{"id":123456789,"name":"CgName2","sourceType":"campaign","sourceKey":{"objectKey":"ck_._siteId_6351166224742316793+campaignId_23456","scope":"campaign","context":"default_context"},"forSiteGuid":"siteguid2","status":"inactive"}""",

      Map(
        1 -> "AAAAAAdbzRUAB0NnTmFtZTICAgAGAAFYI+AIDzl6+QAAAAAAAFugAAlzaXRlZ3VpZDIA",
        2 -> "c1cWlD99m7EAAAACAAAAAAdbzRUAB0NnTmFtZTICAgAGAAFYI+AIDzl6+QAAAAAAAFugAAlzaXRlZ3VpZDIAAA==",
        3 -> "c1cWlD99m7EAAAADAAAAAAdbzRUAB0NnTmFtZTICAgAGAAFYI+AIDzl6+QAAAAAAAFugAAlzaXRlZ3VpZDIAAAAAAAAAAAA="
      ),

      Map(
        1 -> "rO0ABXNyAC9jb20uZ3Jhdml0eS5kb21haW4ucmVjb21tZW5kYXRpb25zLkNvbnRlbnRHcm91cLNsffGwL1NuAgAHSgACaWRaAAxpc0dtc01hbmFnZWRMAAtmb3JTaXRlR3VpZHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wABG5hbWVxAH4AAUwACXNvdXJjZUtleXQAOUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvU2NvcGVkS2V5O0wACnNvdXJjZVR5cGV0ADpMY29tL2dyYXZpdHkvZG9tYWluL2FydGljbGVzL0NvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGU7TAAGc3RhdHVzdAA1TGNvbS9ncmF2aXR5L2RvbWFpbi9hcnRpY2xlcy9Db250ZW50R3JvdXBTdGF0dXMkVHlwZTt4cAAAAAAHW80VAHQACXNpdGVndWlkMnQAB0NnTmFtZTJzcgA3Y29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLmhiYXNlLlNjb3BlZEtleaEq4UNcgvRQAgAFWgAIYml0bWFwJDBMAAdjb250ZXh0dABGTGNvbS9ncmF2aXR5L2ludGVyZXN0cy9qb2JzL2ludGVsbGlnZW5jZS9oYmFzZS9TY29wZWRLZXlDb250ZXh0cyRUeXBlO0wACW9iamVjdEtleXQAPkxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvQ2FuQmVTY29wZWRLZXk7TAAFc2NvcGV0AENMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleVR5cGVzJFR5cGU7TAAIdG9TdHJpbmdxAH4AAXhwAHNyADdjb20uZ3Jhdml0eS51dGlsaXRpZXMuZ3J2ZW51bS5HcnZFbnVtJEdydkVudW1TZXJpYWxpemVkZyCDGkoKiEoCAARMAANjbHN0ABFMamF2YS9sYW5nL0NsYXNzO0wACmV2aWRlbmNlJDF0ABhMc2NhbGEvcmVmbGVjdC9DbGFzc1RhZztMAAJpZHQAEkxqYXZhL2xhbmcvT2JqZWN0O0wABG5hbWVxAH4AAXhwdnIARGNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlDb250ZXh0cyRUeXBlwBvYiSTo9OICAAB4cHNyACVzY2FsYS5yZWZsZWN0Lk1hbmlmZXN0RmFjdG9yeSQkYW5vbiQ3UqUKv37iHHkCAAB4cgAcc2NhbGEucmVmbGVjdC5BbnlWYWxNYW5pZmVzdAAAAAAAAAABAgABTAAIdG9TdHJpbmdxAH4AAXhwdAAFU2hvcnRzcgAPamF2YS5sYW5nLlNob3J0aE03EzRg2lICAAFTAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAABdAAPZGVmYXVsdF9jb250ZXh0c3IAM2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5DYW1wYWlnbktleQAAAAAAAAABAgAEWgAIYml0bWFwJDBKAApjYW1wYWlnbklkTAAHc2l0ZUtleXQAMUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvU2l0ZUtleTtMAAh0b1N0cmluZ3EAfgABeHAAAAAAAAAAW6BzcgAvY29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLlNpdGVLZXm8owMpkjh5GAIAAUoABnNpdGVJZHhwWCPgCA85evlwc3EAfgANdnIAQWNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlUeXBlcyRUeXBl9Tjla51yL48CAAB4cHEAfgAWc3EAfgAYAAZ0AAhjYW1wYWlnbnBzcQB+AA12cgA4Y29tLmdyYXZpdHkuZG9tYWluLmFydGljbGVzLkNvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGX76QkG7jP26gIAAHhwc3IAJXNjYWxhLnJlZmxlY3QuTWFuaWZlc3RGYWN0b3J5JCRhbm9uJDZL8UAzMEGm4AIAAHhxAH4AFXQABEJ5dGVzcgAOamF2YS5sYW5nLkJ5dGWcTmCE7lD1HAIAAUIABXZhbHVleHEAfgAZAnEAfgAlc3EAfgANdnIAM2NvbS5ncmF2aXR5LmRvbWFpbi5hcnRpY2xlcy5Db250ZW50R3JvdXBTdGF0dXMkVHlwZclloWQu4JQEAgAAeHBxAH4AKnNxAH4ALAB0AAhpbmFjdGl2ZQ==",
        2 -> "rO0ABXNyAC9jb20uZ3Jhdml0eS5kb21haW4ucmVjb21tZW5kYXRpb25zLkNvbnRlbnRHcm91cLNsffGwL1NuAgAHSgACaWRaAAxpc0dtc01hbmFnZWRMAAtmb3JTaXRlR3VpZHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wABG5hbWVxAH4AAUwACXNvdXJjZUtleXQAOUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvU2NvcGVkS2V5O0wACnNvdXJjZVR5cGV0ADpMY29tL2dyYXZpdHkvZG9tYWluL2FydGljbGVzL0NvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGU7TAAGc3RhdHVzdAA1TGNvbS9ncmF2aXR5L2RvbWFpbi9hcnRpY2xlcy9Db250ZW50R3JvdXBTdGF0dXMkVHlwZTt4cAAAAAAHW80VAHQACXNpdGVndWlkMnQAB0NnTmFtZTJzcgA3Y29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLmhiYXNlLlNjb3BlZEtleaEq4UNcgvRQAgAFWgAIYml0bWFwJDBMAAdjb250ZXh0dABGTGNvbS9ncmF2aXR5L2ludGVyZXN0cy9qb2JzL2ludGVsbGlnZW5jZS9oYmFzZS9TY29wZWRLZXlDb250ZXh0cyRUeXBlO0wACW9iamVjdEtleXQAPkxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvQ2FuQmVTY29wZWRLZXk7TAAFc2NvcGV0AENMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleVR5cGVzJFR5cGU7TAAIdG9TdHJpbmdxAH4AAXhwAHNyADdjb20uZ3Jhdml0eS51dGlsaXRpZXMuZ3J2ZW51bS5HcnZFbnVtJEdydkVudW1TZXJpYWxpemVkZyCDGkoKiEoCAARMAANjbHN0ABFMamF2YS9sYW5nL0NsYXNzO0wACmV2aWRlbmNlJDF0ABhMc2NhbGEvcmVmbGVjdC9DbGFzc1RhZztMAAJpZHQAEkxqYXZhL2xhbmcvT2JqZWN0O0wABG5hbWVxAH4AAXhwdnIARGNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlDb250ZXh0cyRUeXBlwBvYiSTo9OICAAB4cHNyACVzY2FsYS5yZWZsZWN0Lk1hbmlmZXN0RmFjdG9yeSQkYW5vbiQ3UqUKv37iHHkCAAB4cgAcc2NhbGEucmVmbGVjdC5BbnlWYWxNYW5pZmVzdAAAAAAAAAABAgABTAAIdG9TdHJpbmdxAH4AAXhwdAAFU2hvcnRzcgAPamF2YS5sYW5nLlNob3J0aE03EzRg2lICAAFTAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAABdAAPZGVmYXVsdF9jb250ZXh0c3IAM2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5DYW1wYWlnbktleQAAAAAAAAABAgAEWgAIYml0bWFwJDBKAApjYW1wYWlnbklkTAAHc2l0ZUtleXQAMUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvU2l0ZUtleTtMAAh0b1N0cmluZ3EAfgABeHAAAAAAAAAAW6BzcgAvY29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLlNpdGVLZXm8owMpkjh5GAIAAUoABnNpdGVJZHhwWCPgCA85evlwc3EAfgANdnIAQWNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlUeXBlcyRUeXBl9Tjla51yL48CAAB4cHEAfgAWc3EAfgAYAAZ0AAhjYW1wYWlnbnBzcQB+AA12cgA4Y29tLmdyYXZpdHkuZG9tYWluLmFydGljbGVzLkNvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGX76QkG7jP26gIAAHhwc3IAJXNjYWxhLnJlZmxlY3QuTWFuaWZlc3RGYWN0b3J5JCRhbm9uJDZL8UAzMEGm4AIAAHhxAH4AFXQABEJ5dGVzcgAOamF2YS5sYW5nLkJ5dGWcTmCE7lD1HAIAAUIABXZhbHVleHEAfgAZAnEAfgAlc3EAfgANdnIAM2NvbS5ncmF2aXR5LmRvbWFpbi5hcnRpY2xlcy5Db250ZW50R3JvdXBTdGF0dXMkVHlwZclloWQu4JQEAgAAeHBxAH4AKnNxAH4ALAB0AAhpbmFjdGl2ZQ==",
        3 -> "rO0ABXNyAC9jb20uZ3Jhdml0eS5kb21haW4ucmVjb21tZW5kYXRpb25zLkNvbnRlbnRHcm91cLNsffGwL1NuAgALSgACaWRaAAhpc0F0aGVuYVoADGlzR21zTWFuYWdlZEwADWNodWJDaGFubmVsSWR0ABJMamF2YS9sYW5nL1N0cmluZztMAAxjaHViQ2xpZW50SWRxAH4AAUwACmNodWJGZWVkSWRxAH4AAUwAC2ZvclNpdGVHdWlkcQB+AAFMAARuYW1lcQB+AAFMAAlzb3VyY2VLZXl0ADlMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleTtMAApzb3VyY2VUeXBldAA6TGNvbS9ncmF2aXR5L2RvbWFpbi9hcnRpY2xlcy9Db250ZW50R3JvdXBTb3VyY2VUeXBlcyRUeXBlO0wABnN0YXR1c3QANUxjb20vZ3Jhdml0eS9kb21haW4vYXJ0aWNsZXMvQ29udGVudEdyb3VwU3RhdHVzJFR5cGU7eHAAAAAAB1vNFQAAdAAAcQB+AAZxAH4ABnQACXNpdGVndWlkMnQAB0NnTmFtZTJzcgA3Y29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLmhiYXNlLlNjb3BlZEtleaEq4UNcgvRQAgAFWgAIYml0bWFwJDBMAAdjb250ZXh0dABGTGNvbS9ncmF2aXR5L2ludGVyZXN0cy9qb2JzL2ludGVsbGlnZW5jZS9oYmFzZS9TY29wZWRLZXlDb250ZXh0cyRUeXBlO0wACW9iamVjdEtleXQAPkxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvQ2FuQmVTY29wZWRLZXk7TAAFc2NvcGV0AENMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleVR5cGVzJFR5cGU7TAAIdG9TdHJpbmdxAH4AAXhwAHNyADdjb20uZ3Jhdml0eS51dGlsaXRpZXMuZ3J2ZW51bS5HcnZFbnVtJEdydkVudW1TZXJpYWxpemVkZyCDGkoKiEoCAARMAANjbHN0ABFMamF2YS9sYW5nL0NsYXNzO0wACmV2aWRlbmNlJDF0ABhMc2NhbGEvcmVmbGVjdC9DbGFzc1RhZztMAAJpZHQAEkxqYXZhL2xhbmcvT2JqZWN0O0wABG5hbWVxAH4AAXhwdnIARGNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlDb250ZXh0cyRUeXBlwBvYiSTo9OICAAB4cHNyACVzY2FsYS5yZWZsZWN0Lk1hbmlmZXN0RmFjdG9yeSQkYW5vbiQ3UqUKv37iHHkCAAB4cgAcc2NhbGEucmVmbGVjdC5BbnlWYWxNYW5pZmVzdAAAAAAAAAABAgABTAAIdG9TdHJpbmdxAH4AAXhwdAAFU2hvcnRzcgAPamF2YS5sYW5nLlNob3J0aE03EzRg2lICAAFTAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAABdAAPZGVmYXVsdF9jb250ZXh0c3IAM2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5DYW1wYWlnbktleQAAAAAAAAABAgAEWgAIYml0bWFwJDBKAApjYW1wYWlnbklkTAAHc2l0ZUtleXQAMUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvU2l0ZUtleTtMAAh0b1N0cmluZ3EAfgABeHAAAAAAAAAAW6BzcgAvY29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLlNpdGVLZXm8owMpkjh5GAIAAUoABnNpdGVJZHhwWCPgCA85evlwc3EAfgAOdnIAQWNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlUeXBlcyRUeXBl9Tjla51yL48CAAB4cHEAfgAXc3EAfgAZAAZ0AAhjYW1wYWlnbnBzcQB+AA52cgA4Y29tLmdyYXZpdHkuZG9tYWluLmFydGljbGVzLkNvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGX76QkG7jP26gIAAHhwc3IAJXNjYWxhLnJlZmxlY3QuTWFuaWZlc3RGYWN0b3J5JCRhbm9uJDZL8UAzMEGm4AIAAHhxAH4AFnQABEJ5dGVzcgAOamF2YS5sYW5nLkJ5dGWcTmCE7lD1HAIAAUIABXZhbHVleHEAfgAaAnEAfgAmc3EAfgAOdnIAM2NvbS5ncmF2aXR5LmRvbWFpbi5hcnRpY2xlcy5Db250ZW50R3JvdXBTdGF0dXMkVHlwZclloWQu4JQEAgAAeHBxAH4AK3NxAH4ALQB0AAhpbmFjdGl2ZQ=="
      )
    ),

    TestCaseCg(
      ContentGroup(123456789L, "CgName3", ContentGroupSourceTypes.campaign, CampaignKey(SiteKey("siteguid2"), 23456L).toScopedKey, "siteguid2", ContentGroupStatus.inactive, true),
      2,

      """{"id":123456789,"name":"CgName3","sourceType":"campaign","sourceKey":{"objectKey":"ck_._siteId_6351166224742316793+campaignId_23456","scope":"campaign","context":"default_context"},"forSiteGuid":"siteguid2","status":"inactive","isGmsManaged":true}""",

      Map(
        2 -> "c1cWlD99m7EAAAACAAAAAAdbzRUAB0NnTmFtZTMCAgAGAAFYI+AIDzl6+QAAAAAAAFugAAlzaXRlZ3VpZDIAAQ==",
        3 -> "c1cWlD99m7EAAAADAAAAAAdbzRUAB0NnTmFtZTMCAgAGAAFYI+AIDzl6+QAAAAAAAFugAAlzaXRlZ3VpZDIAAQAAAAAAAAA="
      ),

      Map(
        2 -> "rO0ABXNyAC9jb20uZ3Jhdml0eS5kb21haW4ucmVjb21tZW5kYXRpb25zLkNvbnRlbnRHcm91cLNsffGwL1NuAgAHSgACaWRaAAxpc0dtc01hbmFnZWRMAAtmb3JTaXRlR3VpZHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wABG5hbWVxAH4AAUwACXNvdXJjZUtleXQAOUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvU2NvcGVkS2V5O0wACnNvdXJjZVR5cGV0ADpMY29tL2dyYXZpdHkvZG9tYWluL2FydGljbGVzL0NvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGU7TAAGc3RhdHVzdAA1TGNvbS9ncmF2aXR5L2RvbWFpbi9hcnRpY2xlcy9Db250ZW50R3JvdXBTdGF0dXMkVHlwZTt4cAAAAAAHW80VAXQACXNpdGVndWlkMnQAB0NnTmFtZTNzcgA3Y29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLmhiYXNlLlNjb3BlZEtleaEq4UNcgvRQAgAFWgAIYml0bWFwJDBMAAdjb250ZXh0dABGTGNvbS9ncmF2aXR5L2ludGVyZXN0cy9qb2JzL2ludGVsbGlnZW5jZS9oYmFzZS9TY29wZWRLZXlDb250ZXh0cyRUeXBlO0wACW9iamVjdEtleXQAPkxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvQ2FuQmVTY29wZWRLZXk7TAAFc2NvcGV0AENMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleVR5cGVzJFR5cGU7TAAIdG9TdHJpbmdxAH4AAXhwAHNyADdjb20uZ3Jhdml0eS51dGlsaXRpZXMuZ3J2ZW51bS5HcnZFbnVtJEdydkVudW1TZXJpYWxpemVkZyCDGkoKiEoCAARMAANjbHN0ABFMamF2YS9sYW5nL0NsYXNzO0wACmV2aWRlbmNlJDF0ABhMc2NhbGEvcmVmbGVjdC9DbGFzc1RhZztMAAJpZHQAEkxqYXZhL2xhbmcvT2JqZWN0O0wABG5hbWVxAH4AAXhwdnIARGNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlDb250ZXh0cyRUeXBlwBvYiSTo9OICAAB4cHNyACVzY2FsYS5yZWZsZWN0Lk1hbmlmZXN0RmFjdG9yeSQkYW5vbiQ3UqUKv37iHHkCAAB4cgAcc2NhbGEucmVmbGVjdC5BbnlWYWxNYW5pZmVzdAAAAAAAAAABAgABTAAIdG9TdHJpbmdxAH4AAXhwdAAFU2hvcnRzcgAPamF2YS5sYW5nLlNob3J0aE03EzRg2lICAAFTAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAABdAAPZGVmYXVsdF9jb250ZXh0c3IAM2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5DYW1wYWlnbktleQAAAAAAAAABAgAEWgAIYml0bWFwJDBKAApjYW1wYWlnbklkTAAHc2l0ZUtleXQAMUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvU2l0ZUtleTtMAAh0b1N0cmluZ3EAfgABeHAAAAAAAAAAW6BzcgAvY29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLlNpdGVLZXm8owMpkjh5GAIAAUoABnNpdGVJZHhwWCPgCA85evlwc3EAfgANdnIAQWNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlUeXBlcyRUeXBl9Tjla51yL48CAAB4cHEAfgAWc3EAfgAYAAZ0AAhjYW1wYWlnbnBzcQB+AA12cgA4Y29tLmdyYXZpdHkuZG9tYWluLmFydGljbGVzLkNvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGX76QkG7jP26gIAAHhwc3IAJXNjYWxhLnJlZmxlY3QuTWFuaWZlc3RGYWN0b3J5JCRhbm9uJDZL8UAzMEGm4AIAAHhxAH4AFXQABEJ5dGVzcgAOamF2YS5sYW5nLkJ5dGWcTmCE7lD1HAIAAUIABXZhbHVleHEAfgAZAnEAfgAlc3EAfgANdnIAM2NvbS5ncmF2aXR5LmRvbWFpbi5hcnRpY2xlcy5Db250ZW50R3JvdXBTdGF0dXMkVHlwZclloWQu4JQEAgAAeHBxAH4AKnNxAH4ALAB0AAhpbmFjdGl2ZQ==",
        3 -> "rO0ABXNyAC9jb20uZ3Jhdml0eS5kb21haW4ucmVjb21tZW5kYXRpb25zLkNvbnRlbnRHcm91cLNsffGwL1NuAgALSgACaWRaAAhpc0F0aGVuYVoADGlzR21zTWFuYWdlZEwADWNodWJDaGFubmVsSWR0ABJMamF2YS9sYW5nL1N0cmluZztMAAxjaHViQ2xpZW50SWRxAH4AAUwACmNodWJGZWVkSWRxAH4AAUwAC2ZvclNpdGVHdWlkcQB+AAFMAARuYW1lcQB+AAFMAAlzb3VyY2VLZXl0ADlMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleTtMAApzb3VyY2VUeXBldAA6TGNvbS9ncmF2aXR5L2RvbWFpbi9hcnRpY2xlcy9Db250ZW50R3JvdXBTb3VyY2VUeXBlcyRUeXBlO0wABnN0YXR1c3QANUxjb20vZ3Jhdml0eS9kb21haW4vYXJ0aWNsZXMvQ29udGVudEdyb3VwU3RhdHVzJFR5cGU7eHAAAAAAB1vNFQABdAAAcQB+AAZxAH4ABnQACXNpdGVndWlkMnQAB0NnTmFtZTNzcgA3Y29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLmhiYXNlLlNjb3BlZEtleaEq4UNcgvRQAgAFWgAIYml0bWFwJDBMAAdjb250ZXh0dABGTGNvbS9ncmF2aXR5L2ludGVyZXN0cy9qb2JzL2ludGVsbGlnZW5jZS9oYmFzZS9TY29wZWRLZXlDb250ZXh0cyRUeXBlO0wACW9iamVjdEtleXQAPkxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvQ2FuQmVTY29wZWRLZXk7TAAFc2NvcGV0AENMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleVR5cGVzJFR5cGU7TAAIdG9TdHJpbmdxAH4AAXhwAHNyADdjb20uZ3Jhdml0eS51dGlsaXRpZXMuZ3J2ZW51bS5HcnZFbnVtJEdydkVudW1TZXJpYWxpemVkZyCDGkoKiEoCAARMAANjbHN0ABFMamF2YS9sYW5nL0NsYXNzO0wACmV2aWRlbmNlJDF0ABhMc2NhbGEvcmVmbGVjdC9DbGFzc1RhZztMAAJpZHQAEkxqYXZhL2xhbmcvT2JqZWN0O0wABG5hbWVxAH4AAXhwdnIARGNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlDb250ZXh0cyRUeXBlwBvYiSTo9OICAAB4cHNyACVzY2FsYS5yZWZsZWN0Lk1hbmlmZXN0RmFjdG9yeSQkYW5vbiQ3UqUKv37iHHkCAAB4cgAcc2NhbGEucmVmbGVjdC5BbnlWYWxNYW5pZmVzdAAAAAAAAAABAgABTAAIdG9TdHJpbmdxAH4AAXhwdAAFU2hvcnRzcgAPamF2YS5sYW5nLlNob3J0aE03EzRg2lICAAFTAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAABdAAPZGVmYXVsdF9jb250ZXh0c3IAM2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5DYW1wYWlnbktleQAAAAAAAAABAgAEWgAIYml0bWFwJDBKAApjYW1wYWlnbklkTAAHc2l0ZUtleXQAMUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvU2l0ZUtleTtMAAh0b1N0cmluZ3EAfgABeHAAAAAAAAAAW6BzcgAvY29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLlNpdGVLZXm8owMpkjh5GAIAAUoABnNpdGVJZHhwWCPgCA85evlwc3EAfgAOdnIAQWNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlUeXBlcyRUeXBl9Tjla51yL48CAAB4cHEAfgAXc3EAfgAZAAZ0AAhjYW1wYWlnbnBzcQB+AA52cgA4Y29tLmdyYXZpdHkuZG9tYWluLmFydGljbGVzLkNvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGX76QkG7jP26gIAAHhwc3IAJXNjYWxhLnJlZmxlY3QuTWFuaWZlc3RGYWN0b3J5JCRhbm9uJDZL8UAzMEGm4AIAAHhxAH4AFnQABEJ5dGVzcgAOamF2YS5sYW5nLkJ5dGWcTmCE7lD1HAIAAUIABXZhbHVleHEAfgAaAnEAfgAmc3EAfgAOdnIAM2NvbS5ncmF2aXR5LmRvbWFpbi5hcnRpY2xlcy5Db250ZW50R3JvdXBTdGF0dXMkVHlwZclloWQu4JQEAgAAeHBxAH4AK3NxAH4ALQB0AAhpbmFjdGl2ZQ=="
      )
    ),

    TestCaseCg(
      ContentGroup(123456789L, "CgName4", ContentGroupSourceTypes.campaign, CampaignKey(SiteKey("siteguid2"), 23456L).toScopedKey, "siteguid2", ContentGroupStatus.inactive, false),
      2,

      """{"id":123456789,"name":"CgName4","sourceType":"campaign","sourceKey":{"objectKey":"ck_._siteId_6351166224742316793+campaignId_23456","scope":"campaign","context":"default_context"},"forSiteGuid":"siteguid2","status":"inactive","isGmsManaged":false}""",

      Map(
        2 -> "c1cWlD99m7EAAAACAAAAAAdbzRUAB0NnTmFtZTQCAgAGAAFYI+AIDzl6+QAAAAAAAFugAAlzaXRlZ3VpZDIAAA==",
        3 -> "c1cWlD99m7EAAAADAAAAAAdbzRUAB0NnTmFtZTQCAgAGAAFYI+AIDzl6+QAAAAAAAFugAAlzaXRlZ3VpZDIAAAAAAAAAAAA="
      ),

      Map(
        2 -> "rO0ABXNyAC9jb20uZ3Jhdml0eS5kb21haW4ucmVjb21tZW5kYXRpb25zLkNvbnRlbnRHcm91cLNsffGwL1NuAgAHSgACaWRaAAxpc0dtc01hbmFnZWRMAAtmb3JTaXRlR3VpZHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wABG5hbWVxAH4AAUwACXNvdXJjZUtleXQAOUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvU2NvcGVkS2V5O0wACnNvdXJjZVR5cGV0ADpMY29tL2dyYXZpdHkvZG9tYWluL2FydGljbGVzL0NvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGU7TAAGc3RhdHVzdAA1TGNvbS9ncmF2aXR5L2RvbWFpbi9hcnRpY2xlcy9Db250ZW50R3JvdXBTdGF0dXMkVHlwZTt4cAAAAAAHW80VAHQACXNpdGVndWlkMnQAB0NnTmFtZTRzcgA3Y29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLmhiYXNlLlNjb3BlZEtleaEq4UNcgvRQAgAFWgAIYml0bWFwJDBMAAdjb250ZXh0dABGTGNvbS9ncmF2aXR5L2ludGVyZXN0cy9qb2JzL2ludGVsbGlnZW5jZS9oYmFzZS9TY29wZWRLZXlDb250ZXh0cyRUeXBlO0wACW9iamVjdEtleXQAPkxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvQ2FuQmVTY29wZWRLZXk7TAAFc2NvcGV0AENMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleVR5cGVzJFR5cGU7TAAIdG9TdHJpbmdxAH4AAXhwAHNyADdjb20uZ3Jhdml0eS51dGlsaXRpZXMuZ3J2ZW51bS5HcnZFbnVtJEdydkVudW1TZXJpYWxpemVkZyCDGkoKiEoCAARMAANjbHN0ABFMamF2YS9sYW5nL0NsYXNzO0wACmV2aWRlbmNlJDF0ABhMc2NhbGEvcmVmbGVjdC9DbGFzc1RhZztMAAJpZHQAEkxqYXZhL2xhbmcvT2JqZWN0O0wABG5hbWVxAH4AAXhwdnIARGNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlDb250ZXh0cyRUeXBlwBvYiSTo9OICAAB4cHNyACVzY2FsYS5yZWZsZWN0Lk1hbmlmZXN0RmFjdG9yeSQkYW5vbiQ3UqUKv37iHHkCAAB4cgAcc2NhbGEucmVmbGVjdC5BbnlWYWxNYW5pZmVzdAAAAAAAAAABAgABTAAIdG9TdHJpbmdxAH4AAXhwdAAFU2hvcnRzcgAPamF2YS5sYW5nLlNob3J0aE03EzRg2lICAAFTAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAABdAAPZGVmYXVsdF9jb250ZXh0c3IAM2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5DYW1wYWlnbktleQAAAAAAAAABAgAEWgAIYml0bWFwJDBKAApjYW1wYWlnbklkTAAHc2l0ZUtleXQAMUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvU2l0ZUtleTtMAAh0b1N0cmluZ3EAfgABeHAAAAAAAAAAW6BzcgAvY29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLlNpdGVLZXm8owMpkjh5GAIAAUoABnNpdGVJZHhwWCPgCA85evlwc3EAfgANdnIAQWNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlUeXBlcyRUeXBl9Tjla51yL48CAAB4cHEAfgAWc3EAfgAYAAZ0AAhjYW1wYWlnbnBzcQB+AA12cgA4Y29tLmdyYXZpdHkuZG9tYWluLmFydGljbGVzLkNvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGX76QkG7jP26gIAAHhwc3IAJXNjYWxhLnJlZmxlY3QuTWFuaWZlc3RGYWN0b3J5JCRhbm9uJDZL8UAzMEGm4AIAAHhxAH4AFXQABEJ5dGVzcgAOamF2YS5sYW5nLkJ5dGWcTmCE7lD1HAIAAUIABXZhbHVleHEAfgAZAnEAfgAlc3EAfgANdnIAM2NvbS5ncmF2aXR5LmRvbWFpbi5hcnRpY2xlcy5Db250ZW50R3JvdXBTdGF0dXMkVHlwZclloWQu4JQEAgAAeHBxAH4AKnNxAH4ALAB0AAhpbmFjdGl2ZQ==",
        3 -> "rO0ABXNyAC9jb20uZ3Jhdml0eS5kb21haW4ucmVjb21tZW5kYXRpb25zLkNvbnRlbnRHcm91cLNsffGwL1NuAgALSgACaWRaAAhpc0F0aGVuYVoADGlzR21zTWFuYWdlZEwADWNodWJDaGFubmVsSWR0ABJMamF2YS9sYW5nL1N0cmluZztMAAxjaHViQ2xpZW50SWRxAH4AAUwACmNodWJGZWVkSWRxAH4AAUwAC2ZvclNpdGVHdWlkcQB+AAFMAARuYW1lcQB+AAFMAAlzb3VyY2VLZXl0ADlMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleTtMAApzb3VyY2VUeXBldAA6TGNvbS9ncmF2aXR5L2RvbWFpbi9hcnRpY2xlcy9Db250ZW50R3JvdXBTb3VyY2VUeXBlcyRUeXBlO0wABnN0YXR1c3QANUxjb20vZ3Jhdml0eS9kb21haW4vYXJ0aWNsZXMvQ29udGVudEdyb3VwU3RhdHVzJFR5cGU7eHAAAAAAB1vNFQAAdAAAcQB+AAZxAH4ABnQACXNpdGVndWlkMnQAB0NnTmFtZTRzcgA3Y29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLmhiYXNlLlNjb3BlZEtleaEq4UNcgvRQAgAFWgAIYml0bWFwJDBMAAdjb250ZXh0dABGTGNvbS9ncmF2aXR5L2ludGVyZXN0cy9qb2JzL2ludGVsbGlnZW5jZS9oYmFzZS9TY29wZWRLZXlDb250ZXh0cyRUeXBlO0wACW9iamVjdEtleXQAPkxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvQ2FuQmVTY29wZWRLZXk7TAAFc2NvcGV0AENMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleVR5cGVzJFR5cGU7TAAIdG9TdHJpbmdxAH4AAXhwAHNyADdjb20uZ3Jhdml0eS51dGlsaXRpZXMuZ3J2ZW51bS5HcnZFbnVtJEdydkVudW1TZXJpYWxpemVkZyCDGkoKiEoCAARMAANjbHN0ABFMamF2YS9sYW5nL0NsYXNzO0wACmV2aWRlbmNlJDF0ABhMc2NhbGEvcmVmbGVjdC9DbGFzc1RhZztMAAJpZHQAEkxqYXZhL2xhbmcvT2JqZWN0O0wABG5hbWVxAH4AAXhwdnIARGNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlDb250ZXh0cyRUeXBlwBvYiSTo9OICAAB4cHNyACVzY2FsYS5yZWZsZWN0Lk1hbmlmZXN0RmFjdG9yeSQkYW5vbiQ3UqUKv37iHHkCAAB4cgAcc2NhbGEucmVmbGVjdC5BbnlWYWxNYW5pZmVzdAAAAAAAAAABAgABTAAIdG9TdHJpbmdxAH4AAXhwdAAFU2hvcnRzcgAPamF2YS5sYW5nLlNob3J0aE03EzRg2lICAAFTAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAABdAAPZGVmYXVsdF9jb250ZXh0c3IAM2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5DYW1wYWlnbktleQAAAAAAAAABAgAEWgAIYml0bWFwJDBKAApjYW1wYWlnbklkTAAHc2l0ZUtleXQAMUxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvU2l0ZUtleTtMAAh0b1N0cmluZ3EAfgABeHAAAAAAAAAAW6BzcgAvY29tLmdyYXZpdHkuaW50ZXJlc3RzLmpvYnMuaW50ZWxsaWdlbmNlLlNpdGVLZXm8owMpkjh5GAIAAUoABnNpdGVJZHhwWCPgCA85evlwc3EAfgAOdnIAQWNvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXlUeXBlcyRUeXBl9Tjla51yL48CAAB4cHEAfgAXc3EAfgAZAAZ0AAhjYW1wYWlnbnBzcQB+AA52cgA4Y29tLmdyYXZpdHkuZG9tYWluLmFydGljbGVzLkNvbnRlbnRHcm91cFNvdXJjZVR5cGVzJFR5cGX76QkG7jP26gIAAHhwc3IAJXNjYWxhLnJlZmxlY3QuTWFuaWZlc3RGYWN0b3J5JCRhbm9uJDZL8UAzMEGm4AIAAHhxAH4AFnQABEJ5dGVzcgAOamF2YS5sYW5nLkJ5dGWcTmCE7lD1HAIAAUIABXZhbHVleHEAfgAaAnEAfgAmc3EAfgAOdnIAM2NvbS5ncmF2aXR5LmRvbWFpbi5hcnRpY2xlcy5Db250ZW50R3JvdXBTdGF0dXMkVHlwZclloWQu4JQEAgAAeHBxAH4AK3NxAH4ALQB0AAhpbmFjdGl2ZQ=="
      )
    ),

    TestCaseCg(
      ContentGroup(123456789L, "CgName5", ContentGroupSourceTypes.campaign, CampaignKey(SiteKey("siteguid2"), 23456L).toScopedKey, "siteguid2", ContentGroupStatus.inactive, false, false, "client1", "chan1", "feed1"),
      3,

      """{"id":123456789,"name":"CgName5","sourceType":"campaign","sourceKey":{"objectKey":"ck_._siteId_6351166224742316793+campaignId_23456","scope":"campaign","context":"default_context"},"forSiteGuid":"siteguid2","status":"inactive","isGmsManaged":false,"isAthena":false,"chubClientId":"client1","chubChannelId":"chan1","chubFeedId":"feed1"}""",

      Map(
        3 -> "c1cWlD99m7EAAAADAAAAAAdbzRUAB0NnTmFtZTUCAgAGAAFYI+AIDzl6+QAAAAAAAFugAAlzaXRlZ3VpZDIAAAAAB2NsaWVudDEABWNoYW4xAAVmZWVkMQ=="
      ),

      Map(
        3 -> "rO0ABXNyAC9jb20uZ3Jhdml0eS5kb21haW4ucmVjb21tZW5kYXRpb25zLkNvbnRlbnRHcm91cLNsffGwL1NuAgALSgACaWRaAAhpc0F0aGVuYVoADGlzR21zTWFuYWdlZEwADWNodWJDaGFubmVsSWR0ABJMamF2YS9sYW5nL1N0cmluZztMAAxjaHViQ2xpZW50SWRxAH4AAUwACmNodWJGZWVkSWRxAH4AAUwAC2ZvclNpdGVHdWlkcQB+AAFMAARuYW1lcQB+AAFMAAlzb3VyY2VLZXl0ADlMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleTtMAApzb3VyY2VUeXBldAA6TGNvbS9ncmF2aXR5L2RvbWFpbi9hcnRpY2xlcy9Db250ZW50R3JvdXBTb3VyY2VUeXBlcyRUeXBlO0wABnN0YXR1c3QANUxjb20vZ3Jhdml0eS9kb21haW4vYXJ0aWNsZXMvQ29udGVudEdyb3VwU3RhdHVzJFR5cGU7eHAAAAAAB1vNFQAAdAAFY2hhbjF0AAdjbGllbnQxdAAFZmVlZDF0AAlzaXRlZ3VpZDJ0AAdDZ05hbWU1c3IAN2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXmhKuFDXIL0UAIABVoACGJpdG1hcCQwTAAHY29udGV4dHQARkxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvU2NvcGVkS2V5Q29udGV4dHMkVHlwZTtMAAlvYmplY3RLZXl0AD5MY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL0NhbkJlU2NvcGVkS2V5O0wABXNjb3BldABDTGNvbS9ncmF2aXR5L2ludGVyZXN0cy9qb2JzL2ludGVsbGlnZW5jZS9oYmFzZS9TY29wZWRLZXlUeXBlcyRUeXBlO0wACHRvU3RyaW5ncQB+AAF4cABzcgA3Y29tLmdyYXZpdHkudXRpbGl0aWVzLmdydmVudW0uR3J2RW51bSRHcnZFbnVtU2VyaWFsaXplZGcggxpKCohKAgAETAADY2xzdAARTGphdmEvbGFuZy9DbGFzcztMAApldmlkZW5jZSQxdAAYTHNjYWxhL3JlZmxlY3QvQ2xhc3NUYWc7TAACaWR0ABJMamF2YS9sYW5nL09iamVjdDtMAARuYW1lcQB+AAF4cHZyAERjb20uZ3Jhdml0eS5pbnRlcmVzdHMuam9icy5pbnRlbGxpZ2VuY2UuaGJhc2UuU2NvcGVkS2V5Q29udGV4dHMkVHlwZcAb2Ikk6PTiAgAAeHBzcgAlc2NhbGEucmVmbGVjdC5NYW5pZmVzdEZhY3RvcnkkJGFub24kN1KlCr9+4hx5AgAAeHIAHHNjYWxhLnJlZmxlY3QuQW55VmFsTWFuaWZlc3QAAAAAAAAAAQIAAUwACHRvU3RyaW5ncQB+AAF4cHQABVNob3J0c3IAD2phdmEubGFuZy5TaG9ydGhNNxM0YNpSAgABUwAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAXQAD2RlZmF1bHRfY29udGV4dHNyADNjb20uZ3Jhdml0eS5pbnRlcmVzdHMuam9icy5pbnRlbGxpZ2VuY2UuQ2FtcGFpZ25LZXkAAAAAAAAAAQIABFoACGJpdG1hcCQwSgAKY2FtcGFpZ25JZEwAB3NpdGVLZXl0ADFMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL1NpdGVLZXk7TAAIdG9TdHJpbmdxAH4AAXhwAAAAAAAAAFugc3IAL2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5TaXRlS2V5vKMDKZI4eRgCAAFKAAZzaXRlSWR4cFgj4AgPOXr5cHNxAH4AEHZyAEFjb20uZ3Jhdml0eS5pbnRlcmVzdHMuam9icy5pbnRlbGxpZ2VuY2UuaGJhc2UuU2NvcGVkS2V5VHlwZXMkVHlwZfU45Wudci+PAgAAeHBxAH4AGXNxAH4AGwAGdAAIY2FtcGFpZ25wc3EAfgAQdnIAOGNvbS5ncmF2aXR5LmRvbWFpbi5hcnRpY2xlcy5Db250ZW50R3JvdXBTb3VyY2VUeXBlcyRUeXBl++kJBu4z9uoCAAB4cHNyACVzY2FsYS5yZWZsZWN0Lk1hbmlmZXN0RmFjdG9yeSQkYW5vbiQ2S/FAMzBBpuACAAB4cQB+ABh0AARCeXRlc3IADmphdmEubGFuZy5CeXRlnE5ghO5Q9RwCAAFCAAV2YWx1ZXhxAH4AHAJxAH4AKHNxAH4AEHZyADNjb20uZ3Jhdml0eS5kb21haW4uYXJ0aWNsZXMuQ29udGVudEdyb3VwU3RhdHVzJFR5cGXJZaFkLuCUBAIAAHhwcQB+AC1zcQB+AC8AdAAIaW5hY3RpdmU="
      )
    ),

    TestCaseCg(
      ContentGroup(123456789L, "CgName6", ContentGroupSourceTypes.campaign, CampaignKey(SiteKey("siteguid2"), 23456L).toScopedKey, "siteguid2", ContentGroupStatus.inactive, false, true, "client2", "chan2", "feed2"),
      3,

      """{"id":123456789,"name":"CgName6","sourceType":"campaign","sourceKey":{"objectKey":"ck_._siteId_6351166224742316793+campaignId_23456","scope":"campaign","context":"default_context"},"forSiteGuid":"siteguid2","status":"inactive","isGmsManaged":false,"isAthena":true,"chubClientId":"client2","chubChannelId":"chan2","chubFeedId":"feed2"}""",

      Map(
        3 -> "c1cWlD99m7EAAAADAAAAAAdbzRUAB0NnTmFtZTYCAgAGAAFYI+AIDzl6+QAAAAAAAFugAAlzaXRlZ3VpZDIAAAEAB2NsaWVudDIABWNoYW4yAAVmZWVkMg=="
      ),

      Map(
        3 -> "rO0ABXNyAC9jb20uZ3Jhdml0eS5kb21haW4ucmVjb21tZW5kYXRpb25zLkNvbnRlbnRHcm91cLNsffGwL1NuAgALSgACaWRaAAhpc0F0aGVuYVoADGlzR21zTWFuYWdlZEwADWNodWJDaGFubmVsSWR0ABJMamF2YS9sYW5nL1N0cmluZztMAAxjaHViQ2xpZW50SWRxAH4AAUwACmNodWJGZWVkSWRxAH4AAUwAC2ZvclNpdGVHdWlkcQB+AAFMAARuYW1lcQB+AAFMAAlzb3VyY2VLZXl0ADlMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL1Njb3BlZEtleTtMAApzb3VyY2VUeXBldAA6TGNvbS9ncmF2aXR5L2RvbWFpbi9hcnRpY2xlcy9Db250ZW50R3JvdXBTb3VyY2VUeXBlcyRUeXBlO0wABnN0YXR1c3QANUxjb20vZ3Jhdml0eS9kb21haW4vYXJ0aWNsZXMvQ29udGVudEdyb3VwU3RhdHVzJFR5cGU7eHAAAAAAB1vNFQEAdAAFY2hhbjJ0AAdjbGllbnQydAAFZmVlZDJ0AAlzaXRlZ3VpZDJ0AAdDZ05hbWU2c3IAN2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5oYmFzZS5TY29wZWRLZXmhKuFDXIL0UAIABVoACGJpdG1hcCQwTAAHY29udGV4dHQARkxjb20vZ3Jhdml0eS9pbnRlcmVzdHMvam9icy9pbnRlbGxpZ2VuY2UvaGJhc2UvU2NvcGVkS2V5Q29udGV4dHMkVHlwZTtMAAlvYmplY3RLZXl0AD5MY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL2hiYXNlL0NhbkJlU2NvcGVkS2V5O0wABXNjb3BldABDTGNvbS9ncmF2aXR5L2ludGVyZXN0cy9qb2JzL2ludGVsbGlnZW5jZS9oYmFzZS9TY29wZWRLZXlUeXBlcyRUeXBlO0wACHRvU3RyaW5ncQB+AAF4cABzcgA3Y29tLmdyYXZpdHkudXRpbGl0aWVzLmdydmVudW0uR3J2RW51bSRHcnZFbnVtU2VyaWFsaXplZGcggxpKCohKAgAETAADY2xzdAARTGphdmEvbGFuZy9DbGFzcztMAApldmlkZW5jZSQxdAAYTHNjYWxhL3JlZmxlY3QvQ2xhc3NUYWc7TAACaWR0ABJMamF2YS9sYW5nL09iamVjdDtMAARuYW1lcQB+AAF4cHZyAERjb20uZ3Jhdml0eS5pbnRlcmVzdHMuam9icy5pbnRlbGxpZ2VuY2UuaGJhc2UuU2NvcGVkS2V5Q29udGV4dHMkVHlwZcAb2Ikk6PTiAgAAeHBzcgAlc2NhbGEucmVmbGVjdC5NYW5pZmVzdEZhY3RvcnkkJGFub24kN1KlCr9+4hx5AgAAeHIAHHNjYWxhLnJlZmxlY3QuQW55VmFsTWFuaWZlc3QAAAAAAAAAAQIAAUwACHRvU3RyaW5ncQB+AAF4cHQABVNob3J0c3IAD2phdmEubGFuZy5TaG9ydGhNNxM0YNpSAgABUwAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAXQAD2RlZmF1bHRfY29udGV4dHNyADNjb20uZ3Jhdml0eS5pbnRlcmVzdHMuam9icy5pbnRlbGxpZ2VuY2UuQ2FtcGFpZ25LZXkAAAAAAAAAAQIABFoACGJpdG1hcCQwSgAKY2FtcGFpZ25JZEwAB3NpdGVLZXl0ADFMY29tL2dyYXZpdHkvaW50ZXJlc3RzL2pvYnMvaW50ZWxsaWdlbmNlL1NpdGVLZXk7TAAIdG9TdHJpbmdxAH4AAXhwAAAAAAAAAFugc3IAL2NvbS5ncmF2aXR5LmludGVyZXN0cy5qb2JzLmludGVsbGlnZW5jZS5TaXRlS2V5vKMDKZI4eRgCAAFKAAZzaXRlSWR4cFgj4AgPOXr5cHNxAH4AEHZyAEFjb20uZ3Jhdml0eS5pbnRlcmVzdHMuam9icy5pbnRlbGxpZ2VuY2UuaGJhc2UuU2NvcGVkS2V5VHlwZXMkVHlwZfU45Wudci+PAgAAeHBxAH4AGXNxAH4AGwAGdAAIY2FtcGFpZ25wc3EAfgAQdnIAOGNvbS5ncmF2aXR5LmRvbWFpbi5hcnRpY2xlcy5Db250ZW50R3JvdXBTb3VyY2VUeXBlcyRUeXBl++kJBu4z9uoCAAB4cHNyACVzY2FsYS5yZWZsZWN0Lk1hbmlmZXN0RmFjdG9yeSQkYW5vbiQ2S/FAMzBBpuACAAB4cQB+ABh0AARCeXRlc3IADmphdmEubGFuZy5CeXRlnE5ghO5Q9RwCAAFCAAV2YWx1ZXhxAH4AHAJxAH4AKHNxAH4AEHZyADNjb20uZ3Jhdml0eS5kb21haW4uYXJ0aWNsZXMuQ29udGVudEdyb3VwU3RhdHVzJFR5cGXJZaFkLuCUBAIAAHhwcQB+AC1zcQB+AC8AdAAIaW5hY3RpdmU="
      )
    )
  )

  //
  // Test cases for Seq[ContentGroup]
  //

  case class TestCaseSeqCg(seqCg: Seq[ContentGroup],
                           seqCgVersion: Int,
                           byteConverterVersionToBase64Bytes: Map[Int, String]
                          )

  val testCasesSeqCg: List[TestCaseSeqCg] = List(
    TestCaseSeqCg(
      List(
        ContentGroup(12345L    , "CgName1", ContentGroupSourceTypes.advertiser, SiteKey("siteguid1").toScopedKey                     , "siteguid1", ContentGroupStatus.active),
        ContentGroup(123456789L, "CgName2", ContentGroupSourceTypes.campaign  , CampaignKey(SiteKey("siteguid2"), 23456L).toScopedKey, "siteguid2", ContentGroupStatus.inactive)
      ),
      1,
      Map(
        1 -> "AAAAAgAAACsAAAAAAAAwOQAHQ2dOYW1lMQQCAAEAAVEavbf7IwPEAAlzaXRlZ3VpZDEBAAAAMwAAAAAHW80VAAdDZ05hbWUyAgIABgABWCPgCA85evkAAAAAAABboAAJc2l0ZWd1aWQyAA==",
        2 -> "AAAAAgAAADhzVxaUP32bsQAAAAIAAAAAAAAwOQAHQ2dOYW1lMQQCAAEAAVEavbf7IwPEAAlzaXRlZ3VpZDEBAAAAAEBzVxaUP32bsQAAAAIAAAAAB1vNFQAHQ2dOYW1lMgICAAYAAVgj4AgPOXr5AAAAAAAAW6AACXNpdGVndWlkMgAA",
        3 -> "AAAAAgAAAD9zVxaUP32bsQAAAAMAAAAAAAAwOQAHQ2dOYW1lMQQCAAEAAVEavbf7IwPEAAlzaXRlZ3VpZDEBAAAAAAAAAAAAAABHc1cWlD99m7EAAAADAAAAAAdbzRUAB0NnTmFtZTICAgAGAAFYI+AIDzl6+QAAAAAAAFugAAlzaXRlZ3VpZDIAAAAAAAAAAAA="
      )
    ),

    TestCaseSeqCg(
      List(
        ContentGroup(123456789L, "CgName3", ContentGroupSourceTypes.campaign, CampaignKey(SiteKey("siteguid2"), 23456L).toScopedKey, "siteguid2", ContentGroupStatus.inactive, true),
        ContentGroup(123456789L, "CgName4", ContentGroupSourceTypes.campaign, CampaignKey(SiteKey("siteguid2"), 23456L).toScopedKey, "siteguid2", ContentGroupStatus.inactive, false)
      ),
      2,
      Map(
        2 -> "AAAAAgAAAEBzVxaUP32bsQAAAAIAAAAAB1vNFQAHQ2dOYW1lMwICAAYAAVgj4AgPOXr5AAAAAAAAW6AACXNpdGVndWlkMgABAAAAQHNXFpQ/fZuxAAAAAgAAAAAHW80VAAdDZ05hbWU0AgIABgABWCPgCA85evkAAAAAAABboAAJc2l0ZWd1aWQyAAA=",
        3 -> "AAAAAgAAAEdzVxaUP32bsQAAAAMAAAAAB1vNFQAHQ2dOYW1lMwICAAYAAVgj4AgPOXr5AAAAAAAAW6AACXNpdGVndWlkMgABAAAAAAAAAAAAAEdzVxaUP32bsQAAAAMAAAAAB1vNFQAHQ2dOYW1lNAICAAYAAVgj4AgPOXr5AAAAAAAAW6AACXNpdGVndWlkMgAAAAAAAAAAAA=="
      )
    ),

    TestCaseSeqCg(
      List(
        ContentGroup(123456789L, "CgName5", ContentGroupSourceTypes.campaign, CampaignKey(SiteKey("siteguid2"), 23456L).toScopedKey, "siteguid2", ContentGroupStatus.inactive, false, false, "client1", "chan1", "feed1"),
        ContentGroup(123456789L, "CgName6", ContentGroupSourceTypes.campaign, CampaignKey(SiteKey("siteguid2"), 23456L).toScopedKey, "siteguid2", ContentGroupStatus.inactive, false, true, "client2", "chan2", "feed2")
      ),
      3,
      Map(
        3 -> "AAAAAgAAAFhzVxaUP32bsQAAAAMAAAAAB1vNFQAHQ2dOYW1lNQICAAYAAVgj4AgPOXr5AAAAAAAAW6AACXNpdGVndWlkMgAAAAAHY2xpZW50MQAFY2hhbjEABWZlZWQxAAAAWHNXFpQ/fZuxAAAAAwAAAAAHW80VAAdDZ05hbWU2AgIABgABWCPgCA85evkAAAAAAABboAAJc2l0ZWd1aWQyAAABAAdjbGllbnQyAAVjaGFuMgAFZmVlZDI="
      )
    )
  )

  //
  // JSON tests
  //

  // Huh, the existing Lift serialization is not Lift-deserializable.
  ignore("Test ContentGroup Lift JSON Round-Trip") {
    for (testCase <- testCasesCg) {
      val jsonStr = grvjson.serialize(testCase.cas)
      println(s"jsonStr = $jsonStr")
      assertEquals(testCase.cas.success, grvjson.tryExtract[ContentGroup](jsonStr))
    }
  }

  test("Test ContentGroup Play JSON Round-Trip") {
    implicit val reads = ContentGroup.jsonFormat

    for (testCase <- testCasesCg) {
      Json.fromJson[ContentGroup](Json.parse(Json.stringify(Json.toJson(testCase.cas)))) match {
        case JsSuccess(gotCas, _)    =>
          gotCas should be(testCase.cas)

        case gotBad @ JsError(fails) => {
          println(s"Failures: $fails")
          gotBad.getClass should be(JsSuccess(testCase.cas).getClass)
        }
      }
    }
  }

  //
  // ByteConverter tests
  //

  test("Test ContentGroup ByteConverter Round-Trip") {
    for {
      testCase <- testCasesCg
      if testCase.cgVersion <= ContentGroupByteConverter.writingVersion
    } {
      deepCloneWithComplexByteConverter(testCase.cas) should be(testCase.cas)
    }
  }

  test("Test ByteConverter deserialization of ContentGroup") {
    for {
      (testCase, i) <- testCasesCg.zipWithIndex
      (version, base64Bytes) <- testCase.byteConverterVersionToBase64Bytes
      deserialized = ContentGroupByteConverter.fromBytes(Base64.decodeBase64(base64Bytes))
    } assertEquals(s"Test case #$i byte converter should deserialize version $version", testCase.cas, deserialized)
  }

  //
  // Java serialization tests
  //

  test("Test ContentGroup Java Serialization Round-Trip") {
    for (testCase <- testCasesCg) {
      deepCloneWithJavaSerialization(testCase.cas) should be(testCase.cas)
    }
  }

  test("Test Java deserialization of ContentGroup") {
    for {
      (testCase, i) <- testCasesCg.zipWithIndex
      (version, base64Bytes) <- testCase.versionToJavaBase64Bytes
      deserialized = javaSerBytesToObj[ContentGroup](Base64.decodeBase64(base64Bytes))
    } assertEquals(s"Test case #$i Java should deserialize version $version", testCase.cas, deserialized)
  }

  //
  // Seq[ContentGroup] Tests.
  //
  // These are here to make sure that newer versions of the readers properly consume all the bytes of the older writer's output.
  // (Please ask Tom or JP if you wonder what I'm talking about here)
  //
  test("Test Seq[ContentGroup] ByteConverter Round-Trip") {

    for {
      testCase <- testCasesSeqCg
      if testCase.seqCgVersion <= ContentGroupByteConverter.writingVersion
    } {
      deepCloneWithComplexByteConverter(testCase.seqCg) should be(testCase.seqCg)
    }
  }

  test("Test ByteConverter deserialization of Seq[ContentGroup]") {
    for {
      (testCase, i) <- testCasesSeqCg.zipWithIndex
      (version, base64Bytes) <- testCase.byteConverterVersionToBase64Bytes
      deserialized = ContentGroupSeqByteConverter.fromBytes(Base64.decodeBase64(base64Bytes))
    } assertEquals(s"Test case #$i seq byte converter should deserialize version $version", testCase.seqCg, deserialized)
  }
}

